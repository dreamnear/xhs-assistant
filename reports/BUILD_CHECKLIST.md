# Windows打包检查清单

## ✅ 打包前准备检查

### 在Windows系统上进行以下检查

- [ ] **Python已安装**
  - 检查命令: `python --version`
  - 要求: Python 3.10+
  - 下载: https://www.python.org/downloads/

- [ ] **已添加Python到PATH**
  - 检查命令: `python --version`（如果显示版本说明已添加）
  - 安装时勾选 "Add Python to PATH"

- [ ] **项目文件完整**
  - [ ] main_v2.py（程序入口）
  - [ ] config.py（配置文件）
  - [ ] requirements.txt（依赖清单）
  - [ ] build/build_onefile.spec（打包配置）
  - [ ] build/windows.spec（完整打包配置）
  - [ ] build_windows.bat（自动打包脚本）
  - [ ] core/（核心模块）
  - [ ] modules/（功能模块）
  - [ ] gui/（GUI模块）
  - [ ] utils/（工具模块）

- [ ] **网络连接正常**
  - 需要下载Python包
  - 需要下载Playwright浏览器（约200MB）

---

## 🚀 打包步骤检查

### 步骤1: 准备环境

- [ ] 打开命令提示符（CMD）
- [ ] 进入项目目录: `cd 项目路径`

### 步骤2: 创建虚拟环境

- [ ] 执行: `python -m venv venv`
- [ ] 等待完成（约1分钟）

### 步骤3: 激活虚拟环境

- [ ] 执行: `venv\Scripts\activate`
- [ ] 检查命令提示符前有 `(venv)` 标记

### 步骤4: 安装依赖

- [ ] 执行: `pip install -r requirements.txt`
- [ ] 等待完成（约3-5分钟）
- [ ] 确认没有错误信息

### 步骤5: 安装浏览器

- [ ] 执行: `playwright install chromium`
- [ ] 等待完成（约5-10分钟）
- [ ] 确认下载了Chromium浏览器

### 步骤6: 执行打包

- [ ] 执行: `pyinstaller build/build_onefile.spec --clean`
- [ ] 或使用自动脚本: `build_windows.bat`
- [ ] 等待完成（约5-10分钟）
- [ ] 确认输出没有ERROR级别错误

### 步骤7: 检查输出

- [ ] 检查dist文件夹存在
- [ ] 检查 `小红书数据抓取工具.exe` 文件存在
- [ ] 检查文件大小（约150-200MB）

---

## 🧪 打包后测试检查

### 基本功能测试

- [ ] **程序启动**
  - [ ] 双击exe文件可以启动
  - [ ] GUI界面正常显示
  - [ ] 没有崩溃或错误提示

- [ ] **目录结构**
  - [ ] 程序目录自动创建
  - [ ] .sessions目录自动创建
  - [ ] data目录自动创建
  - [ ] logs目录自动创建

- [ ] **登录功能**
  - [ ] 点击登录按钮打开浏览器
  - [ ] 可以显示二维码
  - [ ] 扫码后登录成功
  - [ ] 会话正确保存

- [ ] **导出功能**
  - [ ] 可以选择笔记数据导出
  - [ ] 可以选择粉丝数据导出
  - [ ] 可以选择7天/30天
  - [ ] 导出进度正常显示
  - [ ] 导出完成提示SUCCESS

- [ ] **文件验证**
  - [ ] data/output目录有导出文件
  - [ ] 笔记数据是Excel格式
  - [ ] 粉丝数据是CSV格式
  - [ ] CSV文件可以正常打开
  - [ ] 中文显示正常

### 完整测试

- [ ] **7天测试**
  - [ ] 选择7天导出
  - [ ] 导出7天数据
  - [ ] 验证数据行数=7

- [ ] **30天测试**
  - [ ] 选择30天导出
  - [ ] 导出30天数据
  - [ ] 验证数据行数=30

- [ ] **重复运行测试**
  - [ ] 关闭程序
  - [ ] 重新打开
  - [ ] 会话自动加载
  - [ ] 无需重新登录

---

## 📦 分发前检查

### 打包准备

- [ ] **文件清理**
  - [ ] 删除临时文件
  - [ ] 删除测试数据
  - [ ] 删除logs目录

- [ ] **文件准备**
  - [ ] 复制exe文件到单独文件夹
  - [ ] 准备使用说明文档
  - [ ] 准备示例文件（可选）

- [ ] **压缩包准备**
  - [ ] 创建ZIP压缩包
  - [ ] 包含exe文件
  - [ ] 包含README文档
  - [ ] 测试解压后可以运行

---

## ✅ 最终确认

- [ ] 所有功能测试通过
- [ ] 没有已知bug
- [ ] 准备好分发文件
- [ ] 准备好用户文档

---

## 🎉 可以分发！

打包完成！可以将 `小红书数据抓取工具.exe` 分发给用户了。

---

## 📝 遇到问题？

### 常见错误

1. **ModuleNotFoundError**
   - 检查 hiddenimports 配置
   - 确保所有依赖已安装

2. **打包失败**
   - 检查Python版本
   - 检查PyInstaller版本
   - 查看详细错误信息

3. **运行报错**
   - 检查数据文件是否包含
   - 检查是否有文件路径问题
   - 查看logs目录的日志文件

### 获取帮助

- 查看详细文档: `WINDOWS_BUILD_GUIDE.md`
- 查看快速参考: `WINDOWS_BUILD_QUICK_REF.md`
- 检查日志文件: `logs/` 目录

---

**祝打包成功！** 🎉
